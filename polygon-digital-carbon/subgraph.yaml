specVersion: 0.0.4
description: Polygon Carbon
repository: https://github.com/KlimaDAO/klima-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: ToucanFactory
    network: matic
    source:
      address: '0x2359677E513Bc83106268514c5B2De3C29C849ea'
      abi: ToucanCarbonOffsetsFactory
      startBlock: 20100000
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/templates/ToucanFactory.ts
      entities:
        - ToucanCarbonOffsetsFactory
      abis:
        - name: ToucanCarbonOffsetsFactory
          file: ../lib/abis/ToucanCarbonOffsetsFactory.json
        - name: ToucanCarbonOffsets
          file: ../lib/abis/ToucanCarbonOffsets.json
        - name: ERC20
          file: ../lib/abis/ERC20.json
      eventHandlers:
        - event: TokenCreated(uint256,address)
          handler: handleNewTCO2
  - kind: ethereum/contract
    name: ToucanCarbonOffsetBatch
    network: matic
    source:
      address: '0x8A4d7458dDe3023A3B24225D62087701A88b09DD'
      abi: ToucanCarbonOffsetBatches
      startBlock: 20078307
    mapping:
      kind: ethereum/events
      language: wasm/assemblyscript
      apiVersion: 0.0.7
      file: ./src/ToucanCarbonOffsetBatchHandler.ts
      entities:
        - ToucanCarbonOffsetBatch
        - name: ToucanCarbonOffsetBatches
      abis:
          file: ../lib/abis/ToucanCarbonOffsetBatches.json
      eventHandlers:
        - event: BatchMinted(address,uint256)
        - event: BatchUpdated(uint256,string,uint256)
          handler: handleBatchMinted
          handler: handleBatchUpdated
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleBatchTransfer
templates:
  - name: ToucanCarbonOffsets
    kind: ethereum/contract
    network: matic
    source:
      abi: ToucanCarbonOffsets
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ToucanCarbonOffsets
      abis:
        - name: ToucanCarbonOffsets
          file: ../lib/abis/ToucanCarbonOffsets.json
        - name: ERC20
          file: ../lib/abis/ERC20.json
      eventHandlers:
        - event: Retired(address,uint256)
          handler: handleToucanRetired
        - event: Retired(address,uint256,uint256)
          handler: handleToucanRetired_1_4_0
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleCreditTransfer
      file: ./src/TransferHandler.ts
  - name: C3ProjectToken
    kind: ethereum/contract
    network: matic
    source:
      abi: C3ProjectToken
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - C3ProjectToken
      abis:
        - name: C3ProjectToken
          file: ../lib/abis/C3ProjectToken.json
        - name: ERC20
          file: ../lib/abis/ERC20.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleCreditTransfer
      file: ./src/TransferHandler.ts
